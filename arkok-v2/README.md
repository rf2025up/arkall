# ğŸš€ ArkOK V2 - æ™ºæ…§æ•™è‚² SaaS å¹³å°

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-2.0.0-green.svg)](https://github.com/your-org/arkok-v2)
[![Status](https://img.shields.io/badge/status-Production%20Ready-brightgreen.svg)](ArkOK_V2_Technical_Whitepaper.md)
[![Whitepaper](https://img.shields.io/badge/ğŸ“‹-Technical%20Whitepaper-blue.svg)](ArkOK_V2_Technical_Whitepaper.md)

> ArkOK V2 æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„æ™ºæ…§æ•™è‚² SaaS å¹³å°ï¼Œé‡‡ç”¨ API é©±åŠ¨çš„æœåŠ¡åŒ–æ¶æ„ï¼Œæ”¯æŒå¤šæ ¡åŒºå¹¶å‘ä½¿ç”¨ï¼Œå…·å¤‡å®Œæ•´çš„å­¦ç”Ÿç®¡ç†å’Œæ¿€åŠ±ç³»ç»Ÿã€‚
> **ğŸ¯ ä» V1 åˆ° V2 çš„æƒŠå¿ƒåŠ¨é­„é‡æ„å†ç¨‹ï¼šä¿æŒå“è¶Šçš„å‰ç«¯ä½“éªŒï¼Œå°†å†…æ ¸å½»åº•æ›¿æ¢ä¸ºä¼ä¸šçº§ SaaS æ¶æ„ã€‚**

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ« **å¤šç§Ÿæˆ·åŸç”Ÿæ¶æ„**: æ•°æ®ä¸¥æ ¼éš”ç¦»ï¼Œæ”¯æŒå•†ä¸šåŒ–è¿è¥
- ğŸš€ **åŒæ ¸é©±åŠ¨**: Node.js ä¸»æœåŠ¡ + Python AI æœåŠ¡ï¼ˆé¢„ç•™ï¼‰
- ğŸ“± **åŒç«¯ä½“éªŒ**: æ‰‹æœºç«¯æ•™å¸ˆåº”ç”¨ + å¤§å±ç«¯æŒ‡æŒ¥ä¸­å¿ƒ
- âš¡ **å®æ—¶åŒæ­¥**: åŸºäº Socket.io çš„å®æ—¶æ•°æ®æ¨é€å’ŒçŠ¶æ€åŒæ­¥
- ğŸ¯ **å®Œæ•´åŠŸèƒ½æ¨¡å—**: ä¹ æƒ¯æ‰“å¡ã€æŒ‘æˆ˜ä»»åŠ¡ã€PKå¯¹å†³ã€å‹‹ç« ç³»ç»Ÿ
- ğŸ›¡ï¸ **ä¼ä¸šçº§å®‰å…¨**: JWT è®¤è¯ã€å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»ã€API é€Ÿç‡é™åˆ¶
- ğŸ® **æ¸¸æˆåŒ–æ¿€åŠ±**: ç§¯åˆ†ç³»ç»Ÿã€ç»éªŒå€¼ã€ç­‰çº§æˆé•¿ã€æˆå°±å‹‹ç« 
- ğŸ”§ **ç»Ÿä¸€æ‰˜ç®¡æ¶æ„**: å•ç«¯å£ Node.js æ‰˜ç®¡ï¼Œå½»åº•è§£å†³éƒ¨ç½²å¤æ‚æ€§é—®é¢˜

## ğŸ“‹ å®Œæ•´æŠ€æœ¯æ¶æ„ç™½çš®ä¹¦

**ğŸ“– [è¯¦ç»†æŠ€æœ¯æ¶æ„ç™½çš®ä¹¦](ArkOK_V2_Technical_Whitepaper.md)** - æ·±å…¥äº†è§£ ArkOK V2 çš„å®Œæ•´æŠ€æœ¯æ¼”è¿›å†ç¨‹å’Œæ¶æ„è®¾è®¡

### ğŸ¯ V1 â†’ V2 é‡æ„é‡Œç¨‹ç¢‘

| é˜¶æ®µ | å…³é”®è¡ŒåŠ¨ | æˆæœ |
|------|----------|------|
| **P1: åœ°åŸºæ­å»º** | å¼•å…¥ Prisma + PostgreSQLï¼Œè®¾è®¡å¤šç§Ÿæˆ· Schema | âœ… å®ç°äº† schoolId æ•°æ®éš”ç¦»ï¼Œæ”¯æŒæ— é™æ‰©å®¹ |
| **P2: ç»Ÿä¸€æ‰˜ç®¡** | åºŸå¼ƒ Nginx/Proxyï¼Œé‡‡ç”¨ Node.js å•ç«¯å£æ‰˜ç®¡ | âœ… å½»åº•è§£å†³äº†å…¬ç½‘è®¿é—®ç™½å±ã€è·¨åŸŸå’Œ CSS åŠ è½½å¤±è´¥é—®é¢˜ |
| **P3: è®¤è¯é‡é“¸** | å…¨å±€ Axios æ‹¦æˆªå™¨ + JWT æ ‡å‡†åŒ– | âœ… å»ºç«‹äº†ç‰¢ä¸å¯ç ´çš„è®¤è¯é“¾è·¯ï¼Œè§£å†³äº†"æ— æƒè®¿é—®"çš„ API é”™è¯¯ |
| **P4: æ•°æ®æ•‘æ´** | ç¼–å†™ CSV æ³¨å…¥è„šæœ¬ä¸æ•°æ®å”¤é†’è„šæœ¬ | âœ… æˆåŠŸæ‰¾å›å¹¶æ¿€æ´»äº† 28 åæ ¸å¿ƒå­¦ç”Ÿçš„å†å²æ•°æ® |
| **P5: çµé­‚é™„ä½“** | åƒç´ çº§å¤åˆ» V1 é¦–é¡µ + åŒæ¨¡å¤§å± | âœ… å®Œç¾æ¢å¤äº†æ©™è‰²ç½‘æ ¼ UI ä¸é•¿æŒ‰äº¤äº’ï¼Œå¹¶ä¸Šçº¿äº†"æ˜Ÿé™…æˆ˜æ–—"æ¨¡å¼ |

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### âœ… å·²å®ŒæˆåŠŸèƒ½æ¨¡å— (v2.0.0 - Production Ready)

#### 1. ä¹ æƒ¯æ‰“å¡ç³»ç»Ÿ ğŸ“
- **åŠŸèƒ½æè¿°**: åŸ¹å…»å­¦ç”Ÿè‰¯å¥½å­¦ä¹ ä¹ æƒ¯çš„æ‰“å¡ç³»ç»Ÿ
- **ä¸»è¦ç‰¹æ€§**:
  - è‡ªå®šä¹‰ä¹ æƒ¯åˆ›å»ºå’Œç®¡ç†ï¼ˆå­¦ä¹ ã€è¿åŠ¨ã€é˜…è¯»ç­‰ï¼‰
  - æ‰¹é‡å­¦ç”Ÿæ‰“å¡åŠŸèƒ½
  - è¿ç»­æ‰“å¡ç»Ÿè®¡å’Œç»éªŒå¥–åŠ±
  - ä¹ æƒ¯æ•°æ®å¯è§†åŒ–å±•ç¤º
- **æŠ€æœ¯å®ç°**: `HabitPage.tsx` + `habit.service.ts` + `habit.routes.ts`

#### 2. æŒ‘æˆ˜ä»»åŠ¡ç³»ç»Ÿ ğŸ¯
- **åŠŸèƒ½æè¿°**: æ¿€å‘å­¦ä¹ åŠ¨åŠ›å’Œå›¢é˜Ÿåä½œçš„æŒ‘æˆ˜å¹³å°
- **ä¸»è¦ç‰¹æ€§**:
  - å¤šç§æŒ‘æˆ˜ç±»å‹ï¼ˆä¸ªäººã€å›¢é˜Ÿã€ç­çº§ï¼‰
  - æŒ‘æˆ˜åˆ›å»ºå’Œå‚ä¸ç®¡ç†
  - è‡ªåŠ¨å¥–åŠ±åˆ†é…ï¼ˆç§¯åˆ†ã€ç»éªŒå€¼ï¼‰
  - æŒ‘æˆ˜è¿›åº¦è·Ÿè¸ªå’Œå†å²è®°å½•
- **æŠ€æœ¯å®ç°**: `ChallengePage.tsx` + `challenge.service.ts` + `challenge.routes.ts`

#### 3. PKå¯¹å†³ç³»ç»Ÿ âš”ï¸
- **åŠŸèƒ½æè¿°**: å¢åŠ å­¦ä¹ è¶£å‘³æ€§å’Œç«äº‰æ„è¯†çš„PKå¹³å°
- **ä¸»è¦ç‰¹æ€§**:
  - å­¦ç”Ÿé—´PKå¯¹å†³åˆ›å»ºå’Œç®¡ç†
  - å¤šç§å¯¹å†³ç±»å‹æ”¯æŒ
  - ç»“æœå…¬å¸ƒå’Œæ’è¡Œæ¦œ
  - å¯¹å†å²è®°å½•å’Œç»Ÿè®¡åˆ†æ
- **æŠ€æœ¯å®ç°**: `PKPage.tsx` + `pkmatch.service.ts` + `pkmatch.routes.ts`

#### 4. å‹‹ç« æˆå°±ç³»ç»Ÿ ğŸ†
- **åŠŸèƒ½æè¿°**: è®°å½•å­¦ç”Ÿæˆé•¿å’Œè¿›æ­¥çš„æˆå°±ç³»ç»Ÿ
- **ä¸»è¦ç‰¹æ€§**:
  - è‡ªå®šä¹‰å‹‹ç« åˆ›å»ºå’Œå›¾æ ‡è®¾ç½®
  - å‹‹ç« é¢å‘æ¡ä»¶å’Œè¦æ±‚å®šä¹‰
  - å­¦ç”Ÿå‹‹ç« ç®¡ç†å’Œç»Ÿè®¡
  - æˆå°±å±•ç¤ºå’Œåˆ†äº«åŠŸèƒ½
- **æŠ€æœ¯å®ç°**: `BadgePage.tsx` + `badge.service.ts` + `badge.routes.ts`

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„æ¦‚è§ˆ

### æ ¸å¿ƒæ¶æ„è®¾è®¡åŸåˆ™

ArkOK V2 é‡‡ç”¨**"ç»Ÿä¸€åç«¯æ‰˜ç®¡ (Unified Backend Hosting)"**æ¨¡å¼ï¼Œè¿™æ˜¯åœ¨ Sealos ç­‰äº‘åŸç”Ÿç¯å¢ƒä¸‹æœ€ç¨³å®šã€æœ€é«˜æ•ˆçš„æ¶æ„ã€‚

```mermaid
graph TD
    User([ç”¨æˆ·/æ•™å¸ˆ/å¤§å±]) -->|HTTPS| Ingress[Sealos Ingress Gateway]
    Ingress -->|æµé‡è½¬å‘| Container[ArkOK V2 å®¹å™¨]

    subgraph Container [Port 3000]
        Core[Node.js (Express) ä¸»æœåŠ¡]

        Core -->|1. é™æ€èµ„æºè¯·æ±‚ (*)| Static[å‰ç«¯æ„å»ºäº§ç‰© (client/dist)]
        Core -->|2. API è¯·æ±‚ (/api/*)| API[ä¸šåŠ¡é€»è¾‘å±‚]
        Core -->|3. å®æ—¶é€šä¿¡ (/socket.io)| Socket[Socket.io æœåŠ¡]
    end

    API --> Service[Service å±‚ (ä¸šåŠ¡é€»è¾‘)]
    Service -->|Prisma ORM| DB[(PostgreSQL æ•°æ®åº“)]
    Socket --> Service
```

### è¯¦ç»†æ¶æ„åˆ†æ

ArkOK V2 é‡‡ç”¨ç°ä»£åŒ–çš„ **"API é©±åŠ¨çš„æœåŠ¡åŒ–æ¶æ„"**ï¼Œå°†ç³»ç»Ÿæ‹†è§£ä¸ºä¸‰ä¸ªèŒè´£å•ä¸€çš„ç‹¬ç«‹éƒ¨åˆ†ï¼š

```mermaid
graph TD
    subgraph "Frontend Client (Vite + React)"
        Mobile_UI[ğŸ“± æ‰‹æœºç«¯ (æ•™å¸ˆ App)]
        BigScreen_UI[ğŸ–¥ï¸ å¤§å±ç«¯ (æŒ‡æŒ¥ä¸­å¿ƒ)]
    end

    subgraph "Backend Server (Node.js + Express)"
        A[API Controller (è·¯ç”±å±‚)]
        B[Business Service (ä¸šåŠ¡é€»è¾‘å±‚)]
        C[Prisma ORM (æ•°æ®è®¿é—®å±‚)]
        D[Socket.io Gateway (å®æ—¶ç½‘å…³)]
    end

    AI_Worker[ğŸ§  AI Worker (Python + FastAPI)]
    Database[(ğŸ˜ PostgreSQL)]

    Mobile_UI -- HTTP/WSS --> A
    BigScreen_UI -- HTTP/WSS --> A

    A --> B
    B --> C
    B --> D
    C --> Database
    B -- "AI Task" --> AI_Worker
    D -- "Real-time Events" --> BigScreen_UI
    D -- "Real-time Events" --> Mobile_UI
```

### å®Œæ•´æŠ€æœ¯æ ˆ

#### å‰ç«¯ (Client)
- **æ¡†æ¶:** React 18 + Vite (æé€Ÿæ„å»º)
- **è¯­è¨€:** TypeScript (ç±»å‹å®‰å…¨)
- **æ ·å¼:** Tailwind CSS (åŸå­åŒ– CSS å¼•æ“)
- **è·¯ç”±:** React Router v6
- **ç½‘ç»œ:** Axios (å¸¦å…¨å±€æ‹¦æˆªå™¨) + Socket.io-client (å®æ—¶)
- **åŠ¨ç”»:** Framer Motion (å¤§å±ç‰¹æ•ˆ)

#### åç«¯ (Server)
- **è¿è¡Œæ—¶:** Node.js + Express
- **è¯­è¨€:** TypeScript
- **ORM:** Prisma (ç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ)
- **æ•°æ®åº“:** PostgreSQL (å…³ç³»å‹æ•°æ®åº“)
- **è®¤è¯:** JWT (JSON Web Tokens)

| é¢†åŸŸ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|----------|------|
| **å‰ç«¯** | React 18 + Vite + TypeScript | ç°ä»£åŒ–å‰ç«¯æ¡†æ¶ï¼Œæ”¯æŒå¿«é€Ÿå¼€å‘ |
| **UIæ¡†æ¶** | Tailwind CSS + Lucide Icons | åŸå­åŒ–CSSï¼Œå“åº”å¼è®¾è®¡ |
| **çŠ¶æ€ç®¡ç†** | React Context + Hooks | è½»é‡çº§çŠ¶æ€ç®¡ç† |
| **è·¯ç”±** | React Router v6 | å•é¡µåº”ç”¨è·¯ç”±ç®¡ç† |
| **åç«¯** | Node.js + Express + TypeScript | é«˜æ€§èƒ½JavaScriptè¿è¡Œæ—¶ |
| **æ•°æ®åº“** | PostgreSQL + Prisma ORM | å…³ç³»å‹æ•°æ®åº“ + ç°ä»£åŒ–ORM |
| **å®æ—¶é€šè®¯** | Socket.io | WebSocketå®æ—¶åŒå‘é€šä¿¡ |
| **è®¤è¯æˆæƒ** | JWT + BCrypt | å®‰å…¨çš„èº«ä»½éªŒè¯æœºåˆ¶ |
| **éƒ¨ç½²** | Sealos (Kubernetes) | äº‘åŸç”Ÿå®¹å™¨ç¼–æ’ |

## ğŸ“ é¡¹ç›®ç»“æ„è¯¦è§£

```
arkok-v2/
â”œâ”€â”€ ğŸ“‚ server/                    # Node.js åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“‚ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ controllers/        # API æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ student.routes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ habit.routes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ challenge.routes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ pkmatch.routes.ts
â”‚   â”‚   â”‚   â””â”€â”€ badge.routes.ts
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ services/           # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ student.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ habit.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ challenge.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ pkmatch.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ badge.service.ts
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ middleware/         # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ auth.middleware.ts
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ gateway/           # Socket.io ç½‘å…³
â”‚   â”‚   â””â”€â”€ ğŸ“„ app.ts             # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ ğŸ“‚ prisma/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ schema.prisma      # æ•°æ®åº“æ¨¡å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ migrations/        # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ ğŸ“„ seed.ts           # æ•°æ®åº“ç§å­æ–‡ä»¶
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“‚ client/                    # React å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ ğŸ“‚ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ HabitPage.tsx     # ä¹ æƒ¯æ‰“å¡é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ChallengePage.tsx # æŒ‘æˆ˜ä»»åŠ¡é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ PKPage.tsx        # PKå¯¹å†³é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ BadgePage.tsx     # å‹‹ç« ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ components/        # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ context/           # å…¨å±€çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ AuthContext.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ routes/            # è·¯ç”±é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ ğŸ“„ App.tsx
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“‚ ai-worker/                 # Python AI æœåŠ¡ (é¢„ç•™)
â”œâ”€â”€ ğŸ“‚ docs/                      # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ ğŸ“„ ARCHITECTURE_WHITEPAPER.md
â”‚   â”œâ”€â”€ ğŸ“„ DEVELOPMENT_GUIDE.md
â”‚   â””â”€â”€ ğŸ“„ API_DOCUMENTATION.md
â”œâ”€â”€ ğŸ“‚ scripts/                   # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ dev.sh                    # å¼€å‘ç¯å¢ƒå¯åŠ¨è„šæœ¬
â””â”€â”€ ğŸ“„ README.md
```

## ğŸš€ æç®€å¯åŠ¨ (ä¸€é”®éƒ¨ç½²)

### ç¯å¢ƒè¦æ±‚

- **Node.js** >= 18.0.0
- **PostgreSQL** >= 13.0
- **Redis** >= 6.0 (å¯é€‰ï¼Œç”¨äºç¼“å­˜)

### ğŸ¯ ä¸€é”®å¯åŠ¨ (Sealos ç¯å¢ƒ)

åœ¨ Sealos ç»ˆç«¯ä¸­ï¼Œåªéœ€ä¸€è¡Œå‘½ä»¤å³å¯å¯åŠ¨æ•´ä¸ªç³»ç»Ÿï¼š

```bash
cd ~/project/arkok-v2
./dev.sh
```

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
   ```bash
   cd /home/devbox/project/arkok-v2
   ```

2. **ç¯å¢ƒé…ç½®**
   ```bash
   # å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
   cp server/.env.example server/.env
   cp client/.env.example client/.env

   # é…ç½®æ•°æ®åº“è¿æ¥
   # ç¼–è¾‘ server/.env æ–‡ä»¶
   ```

3. **æ•°æ®åº“è®¾ç½®**
   ```bash
   cd server
   npx prisma migrate dev    # è¿è¡Œæ•°æ®åº“è¿ç§»
   npx prisma generate      # ç”ŸæˆPrismaå®¢æˆ·ç«¯
   npx prisma db seed       # å¡«å……ç§å­æ•°æ®
   ```

4. **å¯åŠ¨æœåŠ¡**
   ```bash
   # æ–¹å¼ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
   ./dev.sh

   # æ–¹å¼äºŒï¼šæ‰‹åŠ¨å¯åŠ¨
   # ç»ˆç«¯1ï¼šå¯åŠ¨åç«¯æœåŠ¡
   cd server && npm run dev

   # ç»ˆç«¯2ï¼šå¯åŠ¨å‰ç«¯æœåŠ¡
   cd client && npm run dev
   ```

5. **è®¿é—®åº”ç”¨**
   - ğŸŒ **å‰ç«¯åº”ç”¨**: http://localhost:5173
   - ğŸ”Œ **åç«¯API**: http://localhost:3000
   - ğŸ“‹ **å¥åº·æ£€æŸ¥**: http://localhost:3000/health

### ç”Ÿäº§ç¯å¢ƒæ„å»º

```bash
# 1. ç¼–è¯‘å‰ç«¯
cd client && npm run build

# 2. ç¼–è¯‘åç«¯ (è‡ªåŠ¨åŒ…å«åœ¨å¯åŠ¨è„šæœ¬ä¸­)
# 3. å¯åŠ¨
cd .. && ./dev.sh
```

### æ•…éšœæ’æŸ¥ (Troubleshooting)

- **ç™½å±/æ ·å¼ä¸¢å¤±:** è¿è¡Œ `cd client && npm run build` é‡æ–°ç”Ÿæˆé™æ€èµ„æº
- **500 é”™è¯¯:** æ£€æŸ¥ `docs/CURRENT_STATUS.md`ï¼Œç¡®è®¤ Service å±‚æ˜¯å¦éµå¾ªäº† Prisma åˆå§‹åŒ–è§„èŒƒ
- **æ•°æ®ä¸æ˜¾ç¤º:** æ£€æŸ¥æ•°æ®åº“ä¸­å­¦ç”Ÿ `isActive` å­—æ®µæ˜¯å¦ä¸º `true`

## ğŸ”§ å¼€å‘æŒ‡å—

### æ ¸å¿ƒå¼€å‘åŸåˆ™

#### ğŸ¥‡ åŸåˆ™ä¸€ï¼šAPI ä¼˜å…ˆ (API-First)
> "å…ˆæ€è€ƒæ•°æ®å’Œè¡Œä¸ºï¼Œå†æ€è€ƒç•Œé¢ã€‚"

ä»»ä½•æ–°åŠŸèƒ½å¼€å‘éƒ½å¿…é¡»éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š
1. **æ•°æ®æ¨¡å‹è®¾è®¡** â†’ ä¿®æ”¹ `prisma/schema.prisma`
2. **ä¸šåŠ¡é€»è¾‘å®ç°** â†’ åˆ›å»ºæˆ–ä¿®æ”¹å¯¹åº”çš„ `*.service.ts`
3. **APIæ¥å£æš´éœ²** â†’ åˆ›å»ºæˆ–ä¿®æ”¹å¯¹åº”çš„ `*.routes.ts`
4. **å‰ç«¯é¡µé¢å®ç°** â†’ åˆ›å»ºé¡µé¢ç»„ä»¶å¹¶è°ƒç”¨API

#### ğŸ¥ˆ åŸåˆ™äºŒï¼šUI å¤ç”¨ä¸éš”ç¦» (Component & Isolation)
> "èƒ½å¤ç”¨çš„åšæˆç»„ä»¶ï¼Œä¸èƒ½å¤ç”¨çš„åšæˆé¡µé¢ã€‚"

- **é€šç”¨ç»„ä»¶** â†’ æ”¾åœ¨ `client/src/components/`
- **é¡µé¢ç»„ä»¶** â†’ æ”¾åœ¨ `client/src/pages/`
- **å·¥å…·å‡½æ•°** â†’ æ”¾åœ¨ `client/src/utils/`

#### ğŸ¥‰ åŸåˆ™ä¸‰ï¼šå®æ—¶äº¤äº’é©±åŠ¨ (Event-Driven)
> "è®©æ•°æ®è‡ªå·±'è¯´è¯'ï¼Œè€Œä¸æ˜¯è®©ç•Œé¢å»'æ‰“å¬'ã€‚"

1. **åç«¯è§¦å‘äº‹ä»¶**: åœ¨Serviceå±‚è°ƒç”¨Socket.ioå¹¿æ’­
   ```typescript
   io.to(schoolId).emit('STUDENT_SCORE_UPDATED', {
     studentId: 'xxx',
     points: 10,
     exp: 5
   });
   ```

2. **å‰ç«¯ç›‘å¬äº‹ä»¶**: åœ¨éœ€è¦å®æ—¶æ›´æ–°çš„é¡µé¢ä¸­ç›‘å¬
   ```typescript
   socket.on('STUDENT_SCORE_UPDATED', (data) => {
     // æ›´æ–°UIçŠ¶æ€
   });
   ```

### ä»£ç è§„èŒƒ

- **TypeScript**: ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€æœ‰ç±»å‹å¿…é¡»æ˜ç¡®å®šä¹‰
- **ESLint + Prettier**: ç»Ÿä¸€ä»£ç é£æ ¼
- **Conventional Commits**: æ ‡å‡†åŒ–æäº¤ä¿¡æ¯æ ¼å¼
- **æ–‡ä»¶å‘½å**: ä½¿ç”¨ PascalCase (ç»„ä»¶) æˆ– camelCase (å‡½æ•°/å˜é‡)

### API è®¾è®¡è§„èŒƒ

- **RESTful**: éµå¾ªREST APIè®¾è®¡åŸåˆ™
- **ç»Ÿä¸€å“åº”æ ¼å¼**:
  ```typescript
  {
    success: boolean,
    message?: string,
    data?: any,
    error?: string
  }
  ```
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶
- **è®¤è¯æˆæƒ**: æ‰€æœ‰APIéƒ½éœ€è¦JWTè®¤è¯

## ğŸ“¡ API æ–‡æ¡£æ¦‚è§ˆ

### æ ¸å¿ƒAPIç«¯ç‚¹

#### å­¦ç”Ÿç®¡ç† API
- `GET /api/students` - è·å–å­¦ç”Ÿåˆ—è¡¨
- `POST /api/students` - åˆ›å»ºæ–°å­¦ç”Ÿ
- `PUT /api/students/:id` - æ›´æ–°å­¦ç”Ÿä¿¡æ¯
- `POST /api/students/score` - æ›´æ–°å­¦ç”Ÿç§¯åˆ†

#### ä¹ æƒ¯æ‰“å¡ API
- `GET /api/habits` - è·å–ä¹ æƒ¯åˆ—è¡¨
- `POST /api/habits` - åˆ›å»ºæ–°ä¹ æƒ¯
- `POST /api/habits/checkin` - å­¦ç”Ÿæ‰“å¡
- `GET /api/habits/statistics` - è·å–æ‰“å¡ç»Ÿè®¡

#### æŒ‘æˆ˜ä»»åŠ¡ API
- `GET /api/challenges` - è·å–æŒ‘æˆ˜åˆ—è¡¨
- `POST /api/challenges` - åˆ›å»ºæ–°æŒ‘æˆ˜
- `POST /api/challenges/join` - å‚ä¸æŒ‘æˆ˜
- `POST /api/challenges/complete` - å®ŒæˆæŒ‘æˆ˜

#### PKå¯¹å†³ API
- `GET /api/pk-matches` - è·å–PKåˆ—è¡¨
- `POST /api/pk-matches` - åˆ›å»ºPKå¯¹å†³
- `POST /api/pk-matches/result` - å…¬å¸ƒPKç»“æœ
- `GET /api/pk-matches/leaderboard` - è·å–æ’è¡Œæ¦œ

#### å‹‹ç« ç³»ç»Ÿ API
- `GET /api/badges` - è·å–å‹‹ç« åˆ—è¡¨
- `POST /api/badges` - åˆ›å»ºæ–°å‹‹ç« 
- `POST /api/badges/award` - é¢å‘å‹‹ç« 
- `GET /api/badges/student/:studentId` - è·å–å­¦ç”Ÿå‹‹ç« 

### å®æ—¶äº‹ä»¶

- `STUDENT_SCORE_UPDATED` - å­¦ç”Ÿç§¯åˆ†æ›´æ–°
- `HABIT_CHECKIN_COMPLETED` - ä¹ æƒ¯æ‰“å¡å®Œæˆ
- `CHALLENGE_CREATED` - æ–°æŒ‘æˆ˜åˆ›å»º
- `PK_MATCH_FINISHED` - PKå¯¹å†³ç»“æŸ
- `BADGE_AWARDED` - å‹‹ç« é¢å‘

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test:watch

# è¿è¡Œ E2E æµ‹è¯•
npm run test:e2e
```

## ğŸš¦ éƒ¨ç½²

### Sealos äº‘å¹³å°éƒ¨ç½²

1. **æ„å»ºé•œåƒ**
   ```bash
   # æ„å»ºåç«¯é•œåƒ
   docker build -t arkok-v2-server:latest -f server/Dockerfile .

   # æ„å»ºå‰ç«¯é•œåƒ
   docker build -t arkok-v2-client:latest -f client/Dockerfile .
   ```

2. **éƒ¨ç½²é…ç½®**
   ```yaml
   # sealos-deployment.yaml
   apiVersion: apps/v1
   kind: Deployment
   metadata:
     name: arkok-v2
   spec:
     replicas: 2
     selector:
       matchLabels:
         app: arkok-v2
     template:
       metadata:
         labels:
           app: arkok-v2
       spec:
         containers:
         - name: server
           image: arkok-v2-server:latest
           ports:
           - containerPort: 3000
           env:
           - name: NODE_ENV
             value: "production"
   ```

3. **ä¸€é”®éƒ¨ç½²**
   ```bash
   kubectl apply -f sealos-deployment.yaml
   ```

### ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å | è¯´æ˜ | å¼€å‘ç¯å¢ƒé»˜è®¤å€¼ | ç”Ÿäº§ç¯å¢ƒè¦æ±‚ |
|--------|------|----------------|--------------|
| `NODE_ENV` | è¿è¡Œç¯å¢ƒ | `development` | `production` |
| `PORT` | æœåŠ¡ç«¯å£ | `3000` | `3000` |
| `DATABASE_URL` | æ•°æ®åº“è¿æ¥ | `postgresql://...` | å¿…å¡« |
| `REDIS_URL` | Redisè¿æ¥ | å¯é€‰ | æ¨è |
| `JWT_SECRET` | JWTå¯†é’¥ | `dev-secret` | å¼ºå¯†ç  |
| `CORS_ORIGIN` | CORSå…è®¸æº | `http://localhost:5173` | ç”Ÿäº§åŸŸå |

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **APIå“åº”æ—¶é—´**: < 200ms (å¹³å‡)
- **é¡µé¢åŠ è½½æ—¶é—´**: < 2s (é¦–æ¬¡åŠ è½½)
- **å¹¶å‘æ”¯æŒ**: 1000+ æ ¡åŒºåŒæ—¶åœ¨çº¿
- **æ•°æ®ä¸€è‡´æ€§**: å¼ºä¸€è‡´æ€§ä¿è¯
- **ç³»ç»Ÿå¯ç”¨æ€§**: 99.9%

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… **JWTèº«ä»½è®¤è¯**: æ— çŠ¶æ€èº«ä»½éªŒè¯
- âœ… **å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»**: åŸºäºschoolIdçš„ä¸¥æ ¼éš”ç¦»
- âœ… **APIé€Ÿç‡é™åˆ¶**: é˜²æ­¢æ¶æ„è¯·æ±‚
- âœ… **SQLæ³¨å…¥é˜²æŠ¤**: Prisma ORMå‚æ•°åŒ–æŸ¥è¯¢
- âœ… **XSSé˜²æŠ¤**: å‰ç«¯è¾“å…¥éªŒè¯å’Œè½¬ä¹‰
- âœ… **CORSé…ç½®**: è·¨åŸŸè¯·æ±‚å®‰å…¨æ§åˆ¶
- âœ… **HTTPSå¼ºåˆ¶**: ç”Ÿäº§ç¯å¢ƒSSL/TLSåŠ å¯†

## ğŸ¯ é¡¹ç›®çŠ¶æ€

### âœ… ç¬¬ä¸€é˜¶æ®µï¼šåœ°åŸºå·¥ç¨‹ (å·²å®Œæˆ)
- [x] é¡¹ç›®åˆå§‹åŒ–ä¸ç¯å¢ƒéš”ç¦»
- [x] æ•°æ®åº“è®¾è®¡ä¸å¤šç§Ÿæˆ·æ¶æ„
- [x] åŸºç¡€è®¤è¯ä¸æƒé™ç³»ç»Ÿ
- [x] å¼€å‘ç¯å¢ƒæ­å»ºä¸éƒ¨ç½²é…ç½®

### âœ… ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒåŠŸèƒ½å¼€å‘ (å·²å®Œæˆ)
- [x] å­¦ç”Ÿç®¡ç†æ¨¡å— (CRUD + ç§¯åˆ†ç³»ç»Ÿ)
- [x] ä¹ æƒ¯æ‰“å¡ç³»ç»Ÿ (æ‰“å¡ + è¿ç»­ç»Ÿè®¡)
- [x] æŒ‘æˆ˜ä»»åŠ¡ç³»ç»Ÿ (åˆ›å»º + å‚ä¸ + å¥–åŠ±)
- [x] PKå¯¹å†³ç³»ç»Ÿ (åŒ¹é… + ç»“æœ + æ’è¡Œæ¦œ)
- [x] å‹‹ç« æˆå°±ç³»ç»Ÿ (åˆ›å»º + é¢å‘ + ç»Ÿè®¡)
- [x] å®æ—¶æ•°æ®åŒæ­¥ (Socket.ioé›†æˆ)
- [x] æ‰‹æœºç«¯UIå®Œæ•´å®ç°

### ğŸš§ ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½ (è¿›è¡Œä¸­)
- [ ] å¤§å±ç«¯"æ˜Ÿé™…æŒ‡æŒ¥å®˜"UIå®ç°
- [ ] Python AIæœåŠ¡é›†æˆ
- [ ] OCRä½œä¸šæ‰¹æ”¹åŠŸèƒ½
- [ ] æ™ºèƒ½é”™é¢˜åˆ†æç³»ç»Ÿ

### ğŸ“… ç¬¬å››é˜¶æ®µï¼šå•†ä¸šåŒ–åŠŸèƒ½ (è®¡åˆ’ä¸­)
- [ ] å¤šç§Ÿæˆ·ç®¡ç†ç³»ç»Ÿ
- [ ] æ•°æ®ç»Ÿè®¡ä¸åˆ†æ
- [ ] ä¸ªæ€§åŒ–å­¦ä¹ æ¨è
- [ ] ç§»åŠ¨ç«¯åŸç”ŸApp

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. **Forké¡¹ç›®** â†’ åˆ›å»ºä¸ªäººå¼€å‘åˆ†æ”¯
2. **åŠŸèƒ½å¼€å‘** â†’ éµå¾ªAPIä¼˜å…ˆåŸåˆ™
3. **æµ‹è¯•éªŒè¯** â†’ ç¡®ä¿åŠŸèƒ½æ­£å¸¸ä¸”æ— æ€§èƒ½é—®é¢˜
4. **ä»£ç æäº¤** â†’ ä½¿ç”¨Conventional Commitsæ ¼å¼
5. **åˆ›å»ºPR** â†’ è¯¦ç»†æè¿°åŠŸèƒ½å˜æ›´å’Œæµ‹è¯•ç»“æœ

### æäº¤ä¿¡æ¯æ ¼å¼

```
feat: æ·»åŠ æ–°çš„åŠŸèƒ½æ¨¡å—
fix: ä¿®å¤å·²çŸ¥é—®é¢˜
docs: æ›´æ–°æ–‡æ¡£
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æ·»åŠ æˆ–ä¿®æ”¹æµ‹è¯•
chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
```

### ä»£ç å®¡æŸ¥æ ‡å‡†

- âœ… éµå¾ªé¡¹ç›®ä»£ç è§„èŒƒ
- âœ… åŒ…å«å¿…è¦çš„ç±»å‹å®šä¹‰
- âœ… æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†
- âœ… ç¼–å†™å•å…ƒæµ‹è¯•
- âœ… æ›´æ–°ç›¸å…³æ–‡æ¡£

## ğŸ“ æ”¯æŒä¸è”ç³»

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/your-org/arkok-v2
- **é—®é¢˜åé¦ˆ**: https://github.com/your-org/arkok-v2/issues
- **æ–‡æ¡£ç½‘ç«™**: https://arkok-docs.example.com
- **æŠ€æœ¯æ”¯æŒ**: dev@arkok.com

## ğŸ‘¥ å›¢é˜Ÿæˆå‘˜

- **æ¶æ„å¸ˆ**: è´Ÿè´£æ•´ä½“æ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹
- **åç«¯å·¥ç¨‹å¸ˆ**: APIå¼€å‘ã€æ•°æ®åº“è®¾è®¡ã€ä¸šåŠ¡é€»è¾‘å®ç°
- **å‰ç«¯å·¥ç¨‹å¸ˆ**: UI/UXå¼€å‘ã€ç”¨æˆ·ä½“éªŒä¼˜åŒ–ã€ç»„ä»¶åº“ç»´æŠ¤
- **AIå·¥ç¨‹å¸ˆ**: AIåŠŸèƒ½å¼€å‘ã€ç®—æ³•ä¼˜åŒ–ã€æ¨¡å‹è®­ç»ƒ
- **è¿ç»´å·¥ç¨‹å¸ˆ**: éƒ¨ç½²é…ç½®ã€æ€§èƒ½ç›‘æ§ã€ç³»ç»Ÿä¼˜åŒ–

---

## ğŸ¯ è·¯çº¿å›¾ (2025-2026)

### Q4 2025: åŠŸèƒ½å®Œå–„
- [x] æ ¸å¿ƒåŠŸèƒ½æ¨¡å—å¼€å‘
- [ ] å¤§å±ç«¯UIå®ç°
- [ ] æ€§èƒ½ä¼˜åŒ–ä¸æµ‹è¯•
- [ ] æ–‡æ¡£å®Œå–„ä¸éƒ¨ç½²

### Q1 2026: AIé›†æˆ
- [ ] Python AIæœåŠ¡å¼€å‘
- [ ] OCRä½œä¸šæ‰¹æ”¹åŠŸèƒ½
- [ ] æ™ºèƒ½æ¨èç³»ç»Ÿ
- [ ] æ•°æ®åˆ†æå¹³å°

### Q2 2026: å•†ä¸šåŒ–
- [ ] å¤šç§Ÿæˆ·ç®¡ç†åå°
- [ ] è®¢é˜…è®¡è´¹ç³»ç»Ÿ
- [ ] æ•°æ®å¯è§†åŒ–å¤§å±
- [ ] ç§»åŠ¨ç«¯Appå¼€å‘

### Q3-Q4 2026: ç”Ÿæ€æ‰©å±•
- [ ] å¼€æ”¾APIå¹³å°
- [ ] ç¬¬ä¸‰æ–¹é›†æˆ
- [ ] å›½é™…åŒ–æ”¯æŒ
- [ ] å¾®æœåŠ¡æ¶æ„æ¼”è¿›

---

## ğŸ” ä»£ç ä»“åº“ä¿¡æ¯

### Git ä»“åº“é…ç½®

- **ä»“åº“åœ°å€**: https://github.com/rf2025up/arkstar.git
- **ä»“åº“ç±»å‹**: å…¬å¼€ä»“åº“
- **ä¸»è¦åˆ†æ”¯**: master
- **é¡¹ç›®è·¯å¾„**: `arkok-v2/` (å­ç›®å½•)

### éƒ¨ç½²çŠ¶æ€

- **æ¨é€æ—¶é—´**: 2025-12-16
- **æ¨é€å†…å®¹**: ArkOK v2 é¡¹ç›®å®Œæ•´ä»£ç 
- **æäº¤çŠ¶æ€**: æˆåŠŸæ¨é€åˆ° master åˆ†æ”¯
- **æ–‡ä»¶å¤§å°**: åŒ…å«å¤§æ–‡ä»¶è­¦å‘Š (kubectl 57.76 MB)

### è®¿é—®é…ç½®

é¡¹ç›®å·²é…ç½® GitHub Personal Access Tokenï¼Œå…·æœ‰å®Œæ•´çš„ä»“åº“è®¿é—®æƒé™ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå®é™…è®¿é—®å‡­è¯ä¿å­˜åœ¨é¡¹ç›®å®‰å…¨é…ç½®ä¸­ã€‚

### ç»´æŠ¤æŒ‡å—

- æ‰€æœ‰ä»£ç æ›´æ”¹éƒ½åº”æäº¤åˆ°æ­¤ä»“åº“
- ä¿æŒ README æ–‡æ¡£ä¸ä»£ç åŒæ­¥æ›´æ–°
- å®šæœŸå¤‡ä»½é‡è¦æ•°æ®å’Œé…ç½®
- æ³¨æ„ä¿æŠ¤è®¿é—®å‡­è¯çš„å®‰å…¨æ€§

---

**è®©æˆ‘ä»¬ä¸€èµ·ï¼Œç”¨æŠ€æœ¯èµ‹èƒ½æ•™è‚²ï¼Œç”¨åˆ›æ–°æ”¹å˜æœªæ¥ï¼** ğŸš€

*Made with â¤ï¸ by ArkOK Team*

> **Version 2.0.0** | *Last Updated: 2025-12-16*