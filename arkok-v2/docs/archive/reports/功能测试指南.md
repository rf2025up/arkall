# ArkOK V2 功能测试指南

**测试时间**: 2025-12-17
**测试环境**: https://esboimzbkure.sealosbja.site
**服务状态**: ✅ 正常运行

---

## 🧪 测试账号信息

### 龙老师账号（推荐使用）
- **用户名**: long
- **密码**: 123456
- **角色**: 老师
- **学校**: 星途与伴
- **班级**: 六年级1班

---

## 🔍 核心功能测试清单

### 1. 首页学生头像点击测试 📱

**测试步骤**：
1. 使用龙老师账号登录
2. 查看首页学生列表
3. **单击任意学生头像**
4. **验证**: 应该跳转到学生个人详情页 (`/student/:id`)

**预期结果**：
- ✅ 成功跳转到个人详情页
- ✅ 页面显示学生详细信息
- ✅ 包含 🚀成长激励、📚学业攻克、❌错题管理 三个Tab

**代码位置**: `client/src/pages/Home.tsx:241` 导航逻辑

### 2. 长按加分弹窗测试 👆

**测试步骤**：
1. 在首页学生列表
2. **长按任意学生头像（保持600ms）**
3. **验证**: 应该弹出ActionSheet底部抽屉

**预期结果**：
- ✅ 弹出底部操作抽屉
- ✅ 显示积分操作选项
- ✅ 支持不同积分类别（I-VI类）
- ✅ 支持自定义积分输入

**代码位置**: `client/src/pages/Home.tsx:171-207` 长按逻辑

### 3. 备课发布覆盖模式测试 📚

**测试步骤**：
1. 进入备课页面 (`/prep`)
2. 创建备课内容
3. 发布给学生
4. **再次创建不同内容的备课**
5. **验证**: 过关页应该显示最新备课内容

**预期结果**：
- ✅ 新备课覆盖旧备课内容
- ✅ 不会出现重复任务累积
- ✅ 过关页数据与最新备课一致

**代码位置**: `server/src/services/lms.service.ts:267-330` 覆盖逻辑

### 4. 个人详情页数据测试 📊

**测试步骤**：
1. 点击学生头像进入个人详情页
2. 查看各个Tab内容
3. **验证**: 数据是否正常显示

**预期结果**：
- ✅ 成长激励Tab：显示积分、经验、等级
- ✅ 学业攻克Tab：显示任务进度和AI提示词按钮
- ✅ 错题管理Tab：显示错题统计

**代码位置**: `client/src/pages/StudentDetail.tsx` 完整实现

---

## 🛠️ 故障排除指南

### 问题1: 点击头像无响应

**可能原因**：
- 前端JavaScript报错
- 路由配置问题
- 触摸事件冲突

**解决方法**：
1. 打开浏览器开发者工具 (F12)
2. 查看Console是否有JavaScript错误
3. 检查Network标签页API调用状态
4. 验证路由配置 `client/src/routes/index.tsx:60-62`

### 问题2: 长按无弹窗

**可能原因**：
- 长按时间不够（需要600ms）
- 触摸移动距离超过10px
- ActionSheet组件渲染问题

**解决方法**：
1. 确保长按时间超过600ms
2. 长按过程中手指不要移动
3. 检查浏览器控制台是否有错误信息
4. 验证 `client/src/components/ActionSheet.tsx` 组件状态

### 问题3: 备课数据不覆盖

**可能原因**：
- 覆盖逻辑未正确执行
- 数据库查询问题
- 时间范围计算错误

**解决方法**：
2. 查看是否有 `[LMS_OVERWRITE_MODE]` 相关日志
3. 验证时间范围计算是否正确
4. 检查任务删除和创建逻辑

---

## 🔧 调试工具

### 浏览器端调试
```javascript
// 在浏览器控制台执行
console.log('当前Token:', localStorage.getItem('auth_token'));
console.log('当前用户:', JSON.parse(localStorage.getItem('user') || '{}'));
```

### 服务器端调试
```bash
# 查看实时日志

# 查看服务状态
```

### API测试
```bash
# 测试登录接口
curl -X POST https://esboimzbkure.sealosbja.site/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"long","password":"123456"}'

# 测试学生列表（需要替换token）
curl -H "Authorization: Bearer YOUR_TOKEN" \
  https://esboimzbkure.sealosbja.site/api/students
```

---

## 📞 技术支持

如果遇到问题：

1. **检查服务状态**: 访问 https://esboimzbkure.sealosbja.site/health
3. **验证编译状态**: 确认前端代码已重新编译
4. **检查认证状态**: 确认JWT token正常工作

**关键文件位置**：
- 首页逻辑: `client/src/pages/Home.tsx`
- 个人详情页: `client/src/pages/StudentDetail.tsx`
- 备课覆盖逻辑: `server/src/services/lms.service.ts`
- 认证服务: `server/src/services/auth.service.ts`

---

**最后更新**: 2025-12-17 03:18
**服务状态**: ✅ 正常运行，已重新编译前端代码