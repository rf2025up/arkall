# 过关抽屉 UI 设计需求文档 V2

> 供其他 UI 方案参考的完整需求规格

---

## 1. 产品定位

**过关抽屉**是老师在过关页点击学生卡片后弹出的操作面板，用于：
- 查看/修改该学生当日课程进度
- 勾选基础过关项（生字听写、口算等）
- 管理核心教学法、综合成长、定制加餐任务
- 一键结算今日经验值

---

## 2. 信息架构

```
┌─────────────────────────────────────────┐
│  Header: 学生信息 + 日期 + 快捷操作      │
├─────────────────────────────────────────┤
│  进度编辑区: 语文/数学/英语 单元+课程     │
├─────────────────────────────────────────┤
│  学科 Tab: 语文 | 数学 | 英语            │
├─────────────────────────────────────────┤
│  基础过关清单 (静态勾选项)               │
│  ☐ 生字听写  ☐ 课文背诵  ☐ 古诗默写     │
├─────────────────────────────────────────┤
│  核心教学法面板 (红色主题)               │
│  ☑ 作业的自主检查 (+5)                  │
├─────────────────────────────────────────┤
│  综合成长面板 (绿色主题)                 │
│  ☐ 课外阅读30分钟                       │
├─────────────────────────────────────────┤
│  定制加餐面板 (橙色主题) ← 需补全        │
│  ☐ 罚抄错题 (学生:小明)                 │
├─────────────────────────────────────────┤
│  底部结算栏: [待结算 15 EXP] [确认结算]  │
└─────────────────────────────────────────┘
```

---

## 3. 模块详细规格

### 3.1 Header 区

| 元素 | 说明 | 交互 |
|------|------|------|
| 学生姓名 | 大号加粗 | 无 |
| 今日日期 | 周几+日期 | 无 |
| 一键过关 | 绿色按钮 | 点击后所有 PENDING 项变为 COMPLETED |
| 关闭按钮 | X 图标 | 关闭抽屉 |

### 3.2 进度编辑区

| 字段 | 说明 | 数据来源 |
|------|------|----------|
| 语文 | 单元 + 课 + 课程名 | lesson_plans.content.courseInfo |
| 数学 | 单元 + 课程名 | 同上 |
| 英语 | 单元 + 课程名 | 同上 |

**交互**：直接编辑输入框，失焦或按回车时调用 API 更新该学生进度。

### 3.3 学科 Tab

| Tab | 主题色 | 激活样式 |
|-----|--------|----------|
| 语文 | 橙色 | `bg-orange-500 text-white` |
| 数学 | 蓝色 | `bg-blue-600 text-white` |
| 英语 | 紫色 | `bg-indigo-600 text-white` |

### 3.4 基础过关清单

**数据来源**：前端硬编码（不再从后端获取）

| 学科 | 默认清单项 |
|------|-----------|
| 语文 | 生字听写、课文背诵、古诗/日积月累默写、课文理解问答 |
| 数学 | 口算计时、竖式/脱式、概念/公式背默 |
| 英语 | 单词默写、中英互译、句型背诵、课文背诵 |

**交互**：
- 点击未勾选项 → 调用 `POST /lms/records` 创建 COMPLETED 记录
- 点击已勾选项 → 调用 `PATCH /lms/records/:id/status` 切换状态

### 3.5 核心教学法面板

**数据来源**：备课页发布的 `educationalDomain === '核心教学法'` 任务

**UI**：红色圆点标识 + 任务列表 + 右上角"+"按钮（可添加新任务）

### 3.6 综合成长面板

**数据来源**：备课页发布的 `educationalDomain === '综合成长'` 任务

**UI**：绿色圆点标识 + 任务列表 + 右上角"+"按钮

### 3.7 定制加餐面板 ⚠️ 当前缺失

**数据来源**：备课页发布的 `type === 'SPECIAL'` 任务

**UI**：橙色/金色主题 + 任务列表（需显示目标学生名）

### 3.8 底部结算栏

| 元素 | 说明 |
|------|------|
| 待结算 EXP | 累加所有 COMPLETED 任务的 expAwarded |
| 确认结算按钮 | 调用 `PATCH /records/student/:id/pass-all` |

---

## 4. 视觉风格建议

- **整体**：灵动卡片式设计，圆角柔和（24px-32px）
- **背景**：浅灰渐变 `#F8FAFC`
- **卡片**：白色 + 微阴影 + 玻璃感边框
- **动效**：勾选时有弹性缩放反馈
- **间距**：宽松留白，模块间 gap 16-24px

---

## 5. 技术约束

- 抽屉高度：`92vh`（移动端）或全屏侧边栏（桌面端）
- 滚动区域：Header 和底部栏固定，中间内容可滚动
- 状态管理：React useState + 乐观更新

---

## 6. 待确认项

1. [ ] 定制加餐面板是否需要"添加"按钮？
2. [ ] 进度编辑是否需要"保存"确认按钮？
3. [ ] 是否需要显示学生等级/经验条？
