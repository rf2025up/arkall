# 游戏化经验升级系统设计文档

## 一、设计目标

基于"最近发展区"理论，设计一个：
- **激励参与**：让孩子愿意主动完成任务
- **循序渐进**：等级越高难度越大，但不会感到遥不可及
- **匹配成长**：与学生在机构的学习周期相匹配

### 年级目标
| 年级 | 目标等级 | 说明 |
|------|----------|------|
| 1-2年级 | 快速升级 | 建立信心和成就感 |
| 3-4年级 | 30级后有难度 | 需要持续努力 |
| 5-6年级 | 50级以上 | 需完整两年服务 |

### 时间参数
- 一学期：**110 天**
- 一学年：**220 天**
- 完整两年：**440 天**

---

## 二、内容盘点

### 1. 基础过关项（11 项）
| 科目 | 项目 | 经验值 |
|------|------|--------|
| 语文 | 生字听写、课文背诵、古诗/日积月累默写、课文理解问答 | 各 5 exp |
| 数学 | 口算计时、竖式/脱式、概念/公式背默 | 各 5 exp |
| 英语 | 单词默写、中英互译、句型背诵、课文背诵 | 各 5 exp |

### 2. 核心教学法（9 类 36 项）

#### 2.1 基础学习方法论 (5项)
- 作业的自主检查、错题的红笔订正、错题的摘抄与归因
- 用"三色笔法"整理作业、自评当日作业质量

#### 2.2 数学思维与解题策略 (4项)
- 用"分步法"讲解数学题、用"画图法"理解应用题
- 口算限时挑战、错题归类与规律发现

#### 2.3 语文学科能力深化 (4项)
- 课文朗读与背诵、生字词听写、阅读理解策略练习、作文提纲与修改

#### 2.4 英语应用与输出 (4项)
- 单词听写与默写、课文朗读与背诵、口语对话练习、听力理解训练

#### 2.5 阅读深度与分享 (4项)
- 阅读记录卡填写、好词好句摘抄、读后感分享、阅读推荐

#### 2.6 自主学习与规划 (4项)
- 制定学习计划、时间管理练习、目标设定与回顾、自主预习

#### 2.7 课堂互动与深度参与 (4项)
- 主动举手发言、小组讨论参与、提出有价值的问题、帮助同学讲解

#### 2.8 家庭联结与知识迁移 (4项)
- 与家长分享学习内容、生活中的知识应用、家校沟通反馈、家庭作业展示

#### 2.9 高阶输出与创新 (4项)
- 创意写作、项目展示、知识总结思维导图、跨学科应用

**建议经验值**：基础项 8 exp，高阶项 12 exp

### 3. 综合成长（4 类 14 项）

#### 3.1 阅读广度类 (4项)
- 年级同步阅读、课外阅读30分钟、填写阅读记录单、阅读成语故事并积累

#### 3.2 整理与贡献类 (5项)
- 离校前个人卫生清理、书包整理、集体贡献任务、维护秩序、推荐图书

#### 3.3 互助与创新类 (3项)
- 帮助同学、创意表达任务、健康活力任务

#### 3.4 家庭联结类 (2项)
- 与家人共读30分钟、完成家务任务

**建议经验值**：各 8 exp

---

## 三、每日经验来源分析

| 来源 | 频次/天 | 单次经验 | 日均经验 |
|------|---------|----------|----------|
| 基础过关项 | 2-3 项 | 5 exp | 10-15 |
| 核心教学法 | 2-3 项 | 8-12 exp | 16-36 |
| 综合成长 | 1-2 项 | 8 exp | 8-16 |
| 习惯打卡 | 2-5 项 | 3 exp | 6-15 |
| PK 对战 | 0-2 次 | 15 exp | 0-30 |
| 挑战任务 | 0-1 次 | 25 exp | 0-25 |

### 日均经验估算
- **保守估计**（只做基础）：~40 exp/天
- **积极参与**：~80 exp/天
- **全力冲刺**：~120 exp/天

---

## 四、递增式升级曲线（方案 B）

### 设计原则
- 1-5级：快速入门，建立信心
- 6-15级：稳步成长，一学期可达
- 16-30级：挑战区，需要持续努力
- 31-50级：精英区，长期坚持
- 51+级：传奇区，完整两年服务

### 升级公式

```typescript
/**
 * 获取指定等级升级所需的经验值
 */
function getExpRequiredForLevel(level: number): number {
  if (level <= 5) return 30;       // 1-5级：快速入门
  if (level <= 10) return 50;      // 6-10级：建立信心
  if (level <= 15) return 80;      // 11-15级：稳步成长
  if (level <= 20) return 120;     // 16-20级：一学期目标
  if (level <= 25) return 160;     // 21-25级：进阶挑战
  if (level <= 30) return 200;     // 26-30级：挑战区
  if (level <= 40) return 280;     // 31-40级：精英入门
  if (level <= 50) return 400;     // 41-50级：精英区
  return 500;                       // 51+级：传奇区
}

/**
 * 根据总经验计算等级
 */
function calculateLevel(totalExp: number): number {
  let level = 1;
  let expUsed = 0;
  
  while (expUsed + getExpRequiredForLevel(level) <= totalExp) {
    expUsed += getExpRequiredForLevel(level);
    level++;
  }
  
  return level;
}
```

### 升级所需经验表

| 等级区间 | 每级所需 | 区间累计 | 总累计 | 预计天数(80exp/天) |
|----------|----------|----------|--------|---------------------|
| 1-5 级 | 30 | 150 | 150 | ~2 天 |
| 6-10 级 | 50 | 250 | 400 | ~5 天 |
| 11-15 级 | 80 | 400 | 800 | ~10 天 |
| 16-20 级 | 120 | 600 | 1,400 | ~18 天 |
| 21-25 级 | 160 | 800 | 2,200 | ~28 天 |
| 26-30 级 | 200 | 1,000 | 3,200 | ~40 天 |
| 31-40 级 | 280 | 2,800 | 6,000 | ~75 天 |
| 41-50 级 | 400 | 4,000 | 10,000 | ~125 天 |
| 51-60 级 | 500 | 5,000 | 15,000 | ~188 天 |

---

## 五、年级进度预测

假设日均经验：**80 exp**（积极参与型）

| 阶段 | 经验累计 | 预计等级 |
|------|----------|----------|
| 入学 1 个月 | 2,400 | 22 级 |
| 一学期末 (110天) | 8,800 | 42 级 |
| 一学年末 (220天) | 17,600 | 58 级 |
| 完整两年 (440天) | 35,200 | 78 级 |

### 符合设计目标
- ✅ 1-2年级：一学期可达 40+ 级，快速建立成就感
- ✅ 3-4年级：30 级后升级明显变慢，需要持续努力
- ✅ 5-6年级：完整两年可达 70+ 级，成为"传奇"

---

## 六、经验值设置汇总

| 活动类型 | 经验值 |
|----------|--------|
| 基础过关项 | 5 exp |
| 习惯打卡 | 3 exp |
| 核心教学法（基础） | 8 exp |
| 核心教学法（高阶） | 12 exp |
| 综合成长 | 8 exp |
| PK 胜利 | 15 exp |
| 挑战完成 | 25 exp |
| 勋章获得 | 10-50 exp（按稀有度） |

---

## 七、实现状态

- [x] 后端 `getExpRequiredForLevel` 方法
- [x] 后端 `calculateLevel` 方法更新
- [x] 后端 `getLevelProgress` 进度接口
- [x] API `GET /students/:id/level-progress`
- [ ] 前端等级进度条组件
- [ ] 升级动画效果

---

*文档版本：v1.0*  
*更新日期：2025-12-30*
