ğŸš€ Starting ArkOK V2 Server...
ğŸŒ Environment: development
ğŸ”Œ Port: 3000
ğŸ”§ Setting up Socket.IO handlers...
ğŸ”Œ Socket.io æœåŠ¡å·²åˆå§‹åŒ–
âœ… Database connected successfully
ğŸš€ ArkOK V2 Server running on port 3000
2025-12-27T07:37:48.164Z - GET /health
2025-12-27T07:38:33.373Z - GET /
2025-12-27T07:38:33.448Z - GET /assets/index-BX9AZr-Z.js
2025-12-27T07:38:33.450Z - GET /assets/index-BwudlyA0.css
2025-12-27T07:38:33.803Z - GET /api/auth/me
ğŸ” [AUTH_MIDDLEWARE] Processing GET /me
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:33.806Z - GET /vite.svg
2025-12-27T07:38:33.888Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
2025-12-27T07:38:33.893Z - GET /api/students/classes
ğŸ” [AUTH_MIDDLEWARE] Processing GET /classes
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[DEBUG] getClasses - User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
[DEBUG] getClasses - SchoolId: 625e503b-aa7e-44fe-9982-237d828af717
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:38:33.962Z - GET /avatar.jpg
2025-12-27T07:38:35.934Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:35.936Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:35.938Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:35.940Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
2025-12-27T07:38:35.941Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:38:36.032Z - GET /api/lms/batch-daily-records
ğŸ”µ [LMS_ROUTES] GET /batch-daily-records - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /batch-daily-records
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸš€[BATCH_RECORDS] Fetching records for schoolId: 625e503b-aa7e-44fe-9982-237d828af717, date: 2025-12-27, teacherId: 5ca64703-c978-4d01-bf44-a7568f34f556, className: ALL 
2025-12-27T07:38:37.003Z - GET /api/lms/student-progress
ğŸ”µ [LMS_ROUTES] GET /student-progress - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student-progress
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[LMS_PROGRESS] Calculating progress for student: 1896c410-1a91-4281-ac02-797756c638cc 
[LMS_PROGRESS] Times - Plan: 1766766033180, Override: 1766820875866 
2025-12-27T07:38:37.057Z - GET /api/lms/student-progress
ğŸ”µ [LMS_ROUTES] GET /student-progress - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student-progress
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[LMS_PROGRESS] Calculating progress for student: 1896c410-1a91-4281-ac02-797756c638cc 
[LMS_PROGRESS] Times - Plan: 1766766033180, Override: 1766820875866 
2025-12-27T07:38:51.058Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:51.060Z - POST /api/records/progress-override
ğŸ” [AUTH_MIDDLEWARE] Processing POST /progress-override
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸš€ [RECORDS] progress-override - studentId=1896c410-1a91-4281-ac02-797756c638cc, teacherId=5ca64703-c978-4d01-bf44-a7568f34f556
2025-12-27T07:38:51.062Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:51.064Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ“¡ Broadcasted to student-1896c410-1a91-4281-ac02-797756c638cc: DATA_UPDATE
2025-12-27T07:38:54.703Z - GET /qc
2025-12-27T07:38:54.772Z - GET /assets/index-BwudlyA0.css
2025-12-27T07:38:54.772Z - GET /assets/index-BX9AZr-Z.js
2025-12-27T07:38:54.867Z - GET /api/auth/me
ğŸ” [AUTH_MIDDLEWARE] Processing GET /me
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:54.872Z - GET /vite.svg
2025-12-27T07:38:54.962Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:54.964Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:54.967Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:54.968Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
2025-12-27T07:38:54.970Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
2025-12-27T07:38:54.971Z - GET /api/students/classes
ğŸ” [AUTH_MIDDLEWARE] Processing GET /classes
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[DEBUG] getClasses - User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
[DEBUG] getClasses - SchoolId: 625e503b-aa7e-44fe-9982-237d828af717
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
2025-12-27T07:38:55.028Z - GET /api/lms/batch-daily-records
ğŸ”µ [LMS_ROUTES] GET /batch-daily-records - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /batch-daily-records
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸš€[BATCH_RECORDS] Fetching records for schoolId: 625e503b-aa7e-44fe-9982-237d828af717, date: 2025-12-27, teacherId: 5ca64703-c978-4d01-bf44-a7568f34f556, className: ALL 
2025-12-27T07:38:55.103Z - GET /avatar.jpg
2025-12-27T07:38:55.823Z - GET /api/lms/student-progress
ğŸ”µ [LMS_ROUTES] GET /student-progress - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student-progress
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[LMS_PROGRESS] Calculating progress for student: 1896c410-1a91-4281-ac02-797756c638cc 
[LMS_PROGRESS] Times - Plan: 1766766033180, Override: 1766821131062 
2025-12-27T07:38:55.888Z - GET /api/lms/student-progress
ğŸ”µ [LMS_ROUTES] GET /student-progress - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student-progress
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[LMS_PROGRESS] Calculating progress for student: 1896c410-1a91-4281-ac02-797756c638cc 
[LMS_PROGRESS] Times - Plan: 1766766033180, Override: 1766821131062 
2025-12-27T07:38:57.673Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:57.681Z - POST /api/records/progress-override
ğŸ” [AUTH_MIDDLEWARE] Processing POST /progress-override
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸš€ [RECORDS] progress-override - studentId=1896c410-1a91-4281-ac02-797756c638cc, teacherId=5ca64703-c978-4d01-bf44-a7568f34f556
2025-12-27T07:38:57.683Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:38:57.685Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ“¡ Broadcasted to student-1896c410-1a91-4281-ac02-797756c638cc: DATA_UPDATE
2025-12-27T07:39:21.774Z - GET /qc
2025-12-27T07:39:21.863Z - GET /assets/index-BX9AZr-Z.js
2025-12-27T07:39:21.864Z - GET /assets/index-BwudlyA0.css
2025-12-27T07:39:21.998Z - GET /vite.svg
2025-12-27T07:39:21.998Z - GET /api/auth/me
ğŸ” [AUTH_MIDDLEWARE] Processing GET /me
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:22.068Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:22.073Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:22.075Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:22.076Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
2025-12-27T07:39:22.077Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
2025-12-27T07:39:22.078Z - GET /api/students/classes
ğŸ” [AUTH_MIDDLEWARE] Processing GET /classes
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[DEBUG] getClasses - User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
[DEBUG] getClasses - SchoolId: 625e503b-aa7e-44fe-9982-237d828af717
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
2025-12-27T07:39:22.137Z - GET /api/lms/batch-daily-records
ğŸ”µ [LMS_ROUTES] GET /batch-daily-records - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /batch-daily-records
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸš€[BATCH_RECORDS] Fetching records for schoolId: 625e503b-aa7e-44fe-9982-237d828af717, date: 2025-12-27, teacherId: 5ca64703-c978-4d01-bf44-a7568f34f556, className: ALL 
2025-12-27T07:39:22.213Z - GET /avatar.jpg
2025-12-27T07:39:24.283Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: undefined,
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: undefined,
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Default: querying students for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: undefined
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:39:25.244Z - GET /api/reward/configs/625e503b-aa7e-44fe-9982-237d828af717
2025-12-27T07:39:27.173Z - GET /api/lms/latest-lesson-plan
ğŸ”µ [LMS_ROUTES] GET /latest-lesson-plan - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /latest-lesson-plan
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:27.183Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
2025-12-27T07:39:27.184Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:27.186Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:27.187Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:27.188Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
2025-12-27T07:39:27.248Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:27.258Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:27.259Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:27.633Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:39:29.733Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:29.738Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:29.739Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:29.740Z - GET /api/lms/latest-lesson-plan
ğŸ”µ [LMS_ROUTES] GET /latest-lesson-plan - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /latest-lesson-plan
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:29.741Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
2025-12-27T07:39:29.742Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:39:30.698Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:30.700Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:30.701Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:39:30.702Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
2025-12-27T07:39:30.703Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
2025-12-27T07:39:30.778Z - GET /api/lms/batch-daily-records
ğŸ”µ [LMS_ROUTES] GET /batch-daily-records - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /batch-daily-records
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸš€[BATCH_RECORDS] Fetching records for schoolId: 625e503b-aa7e-44fe-9982-237d828af717, date: 2025-12-27, teacherId: 5ca64703-c978-4d01-bf44-a7568f34f556, className: ALL 
2025-12-27T07:39:31.777Z - GET /api/lms/student-progress
ğŸ”µ [LMS_ROUTES] GET /student-progress - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student-progress
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[LMS_PROGRESS] Calculating progress for student: 1896c410-1a91-4281-ac02-797756c638cc 
[LMS_PROGRESS] Times - Plan: 1766766033180, Override: 1766821137682 
2025-12-27T07:39:31.853Z - GET /api/lms/student-progress
ğŸ”µ [LMS_ROUTES] GET /student-progress - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student-progress
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[LMS_PROGRESS] Calculating progress for student: 1896c410-1a91-4281-ac02-797756c638cc 
[LMS_PROGRESS] Times - Plan: 1766766033180, Override: 1766821137682 
2025-12-27T07:40:13.959Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:40:13.961Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:40:13.962Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:40:13.963Z - GET /api/lms/latest-lesson-plan
ğŸ”µ [LMS_ROUTES] GET /latest-lesson-plan - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /latest-lesson-plan
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:40:13.965Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
2025-12-27T07:40:13.966Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:40:15.622Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
2025-12-27T07:40:15.624Z - GET /avatar.jpg
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:40:16.813Z - GET /api/badges/stats
ğŸ” [AUTH_MIDDLEWARE] Processing GET /stats
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:40:16.815Z - GET /api/badges
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:40:16.816Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  limit: '100'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: 100,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 563,
      exp: 217,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 100, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:40:32.633Z - POST /api/badges/award/batch
ğŸ” [AUTH_MIDDLEWARE] Processing POST /award/batch
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ“¡ Broadcasted to school 625e503b-aa7e-44fe-9982-237d828af717: BADGES_BATCH_AWARDED
2025-12-27T07:40:32.707Z - GET /api/badges
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:40:32.708Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  limit: '100'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: 100,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
2025-12-27T07:40:32.712Z - GET /api/badges/stats
ğŸ” [AUTH_MIDDLEWARE] Processing GET /stats
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 100, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:41:27.928Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:41:27.932Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:41:27.933Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:41:27.934Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
2025-12-27T07:41:27.935Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
2025-12-27T07:41:28.007Z - GET /api/lms/batch-daily-records
ğŸ”µ [LMS_ROUTES] GET /batch-daily-records - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /batch-daily-records
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸš€[BATCH_RECORDS] Fetching records for schoolId: 625e503b-aa7e-44fe-9982-237d828af717, date: 2025-12-27, teacherId: 5ca64703-c978-4d01-bf44-a7568f34f556, className: ALL 
2025-12-27T07:41:28.907Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: undefined,
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: undefined,
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Default: querying students for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: undefined
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:41:30.937Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:41:33.837Z - GET /api/parent/feedbacks
2025-12-27T07:41:35.692Z - POST /api/parent/feedbacks/read-all
2025-12-27T07:42:00.378Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:42:00.379Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:42:00.381Z - GET /api/records/curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Processing GET /curriculum/syllabus
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:42:00.382Z - GET /api/lms/latest-lesson-plan
ğŸ”µ [LMS_ROUTES] GET /latest-lesson-plan - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /latest-lesson-plan
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:42:00.383Z - GET /api/lms/task-library
ğŸ”µ [LMS_ROUTES] GET /task-library - Body: {}
ğŸ” [AUTH_MIDDLEWARE] Processing GET /task-library
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” [LMS_SERVICE] å¼€å§‹è·å–ä»»åŠ¡åº“æ•°æ®...
2025-12-27T07:42:00.384Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
ğŸ”[LMS_SERVICE] ä»»åŠ¡åº“æ´»è·ƒä»»åŠ¡æ•°é‡: 82 
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
âœ…[LMS_SERVICE] æˆåŠŸè·å–ä»»åŠ¡åº“ï¼Œä»»åŠ¡æ•°é‡: 82 
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:42:01.417Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:42:02.202Z - GET /api/students/1896c410-1a91-4281-ac02-797756c638cc/profile
ğŸ” [AUTH_MIDDLEWARE] Processing GET /1896c410-1a91-4281-ac02-797756c638cc/profile
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” è·å–å­¦ç”Ÿæ¡£æ¡ˆ: 1896c410-1a91-4281-ac02-797756c638cc, å­¦æ ¡: 625e503b-aa7e-44fe-9982-237d828af717
2025-12-27T07:42:02.205Z - GET /api/checkins/student/1896c410-1a91-4281-ac02-797756c638cc/monthly
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student/1896c410-1a91-4281-ac02-797756c638cc/monthly
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ¯ [HABIT_DEBUG] allHabits æ•°é‡: 19, studentHabitLogs æ•°é‡: 9
ğŸ¯ [HABIT_DEBUG] ç”Ÿæˆçš„ habitStats æ•°é‡: 19, æœ‰æ‰“å¡è®°å½•çš„ä¹ æƒ¯: 6
âœ… å­¦ç”Ÿæ¡£æ¡ˆè·å–æˆåŠŸ: å®å¯æ­†, åŒ…å« 153 æ¡ä»»åŠ¡è®°å½•, 10 æ¡PKè®°å½•
2025-12-27T07:42:04.628Z - GET /api/parent/students/1896c410-1a91-4281-ac02-797756c638cc/parents
2025-12-27T07:42:17.803Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:42:19.196Z - GET /api/checkins/student/31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb/monthly
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student/31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb/monthly
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:42:19.198Z - GET /api/students/31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb/profile
ğŸ” [AUTH_MIDDLEWARE] Processing GET /31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb/profile
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” è·å–å­¦ç”Ÿæ¡£æ¡ˆ: 31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb, å­¦æ ¡: 625e503b-aa7e-44fe-9982-237d828af717
ğŸ¯ [HABIT_DEBUG] allHabits æ•°é‡: 19, studentHabitLogs æ•°é‡: 1
ğŸ¯ [HABIT_DEBUG] ç”Ÿæˆçš„ habitStats æ•°é‡: 19, æœ‰æ‰“å¡è®°å½•çš„ä¹ æƒ¯: 1
âœ… å­¦ç”Ÿæ¡£æ¡ˆè·å–æˆåŠŸ: æ›¾æ¬£åª›, åŒ…å« 111 æ¡ä»»åŠ¡è®°å½•, 7 æ¡PKè®°å½•
2025-12-27T07:42:27.302Z - GET /api/parent/students/31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb/parents
2025-12-27T07:42:58.248Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:42:59.438Z - GET /api/pkmatches
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:42:59.447Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: { schoolId: '625e503b-aa7e-44fe-9982-237d828af717', limit: '100' }
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: 100,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: undefined,
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: undefined,
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Default: querying students for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: undefined
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 100, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:43:02.727Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
2025-12-27T07:43:03.942Z - GET /api/checkins/student/65697759-b4ba-49ae-9f18-101730f7bf47/monthly
ğŸ” [AUTH_MIDDLEWARE] Processing GET /student/65697759-b4ba-49ae-9f18-101730f7bf47/monthly
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
2025-12-27T07:43:03.944Z - GET /api/students/65697759-b4ba-49ae-9f18-101730f7bf47/profile
ğŸ” [AUTH_MIDDLEWARE] Processing GET /65697759-b4ba-49ae-9f18-101730f7bf47/profile
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
ğŸ” è·å–å­¦ç”Ÿæ¡£æ¡ˆ: 65697759-b4ba-49ae-9f18-101730f7bf47, å­¦æ ¡: 625e503b-aa7e-44fe-9982-237d828af717
ğŸ¯ [HABIT_DEBUG] allHabits æ•°é‡: 19, studentHabitLogs æ•°é‡: 0
ğŸ¯ [HABIT_DEBUG] ç”Ÿæˆçš„ habitStats æ•°é‡: 19, æœ‰æ‰“å¡è®°å½•çš„ä¹ æƒ¯: 0
âœ… å­¦ç”Ÿæ¡£æ¡ˆè·å–æˆåŠŸ: åˆ˜æ¢“èŒ, åŒ…å« 20 æ¡ä»»åŠ¡è®°å½•, 3 æ¡PKè®°å½•
2025-12-27T07:43:06.482Z - GET /api/parent/students/65697759-b4ba-49ae-9f18-101730f7bf47/parents
2025-12-27T07:43:18.723Z - GET /api/students
ğŸ” [AUTH_MIDDLEWARE] Processing GET /
ğŸ” [AUTH_MIDDLEWARE] Token found: true, Length: 467
ğŸ” [AUTH_MIDDLEWARE] Token verification result: true
âœ… [AUTH_MIDDLEWARE] User authenticated: long (TEACHER)
--- [DEBUG] GET /api/students endpoint hit ---
Authenticated User: {
  userId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  username: 'long',
  name: 'é¾™è€å¸ˆ',
  displayName: 'é¾™è€å¸ˆ',
  email: null,
  role: 'TEACHER',
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  schoolName: 'æ˜Ÿé€”ä¸ä¼´',
  primaryClassName: 'å…­å¹´çº§1ç­'
}
School ID from user: 625e503b-aa7e-44fe-9982-237d828af717
Request query params: {
  scope: 'MY_STUDENTS',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  userRole: 'TEACHER'
}
[DEBUG] Query object sent to service: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  className: undefined,
  search: undefined,
  page: undefined,
  limit: undefined,
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER',
  requesterId: '5ca64703-c978-4d01-bf44-a7568f34f556'
}
[DEBUG] âœ… teacherId is present: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] Fetching students with query: {
  schoolId: '625e503b-aa7e-44fe-9982-237d828af717',
  teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
  scope: 'MY_STUDENTS',
  userRole: 'TEACHER'
}
[DEBUG] ğŸ” Checking teacherId distribution before query...
[DEBUG] ğŸ“Š TeacherId distribution: {
  '10a89d3e-7b40-461c-a6dd-b71c00111fbf': 9,
  '5d26104b-58a4-4c38-90d6-d03ff7fa76de': 12,
  '5ca64703-c978-4d01-bf44-a7568f34f556': 8
}
[DEBUG] ğŸ“Š Total students in DB: 29
[TEACHER BINDING] Querying MY_STUDENTS for teachers: 5ca64703-c978-4d01-bf44-a7568f34f556
[TEACHER BINDING] âš ï¸ Using teacherId only for student filtering (className filter removed)
[TEACHER BINDING] âœ… Found 8 students for scope: MY_STUDENTS
[DEBUG] Service returned: {
  students: [
    {
      id: '1896c410-1a91-4281-ac02-797756c638cc',
      name: 'å®å¯æ­†',
      className: null,
      avatarUrl: null,
      points: 7640,
      exp: 5012,
      level: 36,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
      name: 'æ›¾æ¬£åª›',
      className: null,
      avatarUrl: null,
      points: 322,
      exp: 1300,
      level: 4,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'b043aea7-874b-4505-8274-50526192fde8',
      name: 'è‚–æµ©è½©',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 298,
      exp: 623,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'a3a72793-7c76-4f14-b18c-d786db55ff26',
      name: 'æ¨Šç‰§å®¸',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 329,
      exp: 398,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: 'bb61ac5c-9bee-4ff9-95ef-1d9e25728f76',
      name: 'è‚–é›¨è™¹',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1606,
      exp: 366,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '83147758-d2d7-4541-a7c1-5892b809ccc8',
      name: 'å½­æ–¯æ™Ÿ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 573,
      exp: 237,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '65697759-b4ba-49ae-9f18-101730f7bf47',
      name: 'åˆ˜æ¢“èŒ',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 681,
      exp: 221,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    },
    {
      id: '47938c35-a307-4191-84a8-bf798d599505',
      name: 'å»–æ½‡ç„¶',
      className: 'å…­å¹´çº§1ç­',
      avatarUrl: null,
      points: 1211,
      exp: 210,
      level: 1,
      teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
      isActive: true
    }
  ],
  pagination: { page: 1, limit: 8, total: 8, totalPages: 1 }
}
[DEBUG] Number of students in result: 8
[DEBUG] Students data preview: [
  {
    id: '1896c410-1a91-4281-ac02-797756c638cc',
    name: 'å®å¯æ­†',
    className: null,
    avatarUrl: null,
    points: 7640,
    exp: 5012,
    level: 36,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  },
  {
    id: '31895b6e-8fb0-4eb8-838c-3c0d3d71bbcb',
    name: 'æ›¾æ¬£åª›',
    className: null,
    avatarUrl: null,
    points: 322,
    exp: 1300,
    level: 4,
    teacherId: '5ca64703-c978-4d01-bf44-a7568f34f556',
    isActive: true
  }
]
[DEBUG] Response sent to frontend successfully
