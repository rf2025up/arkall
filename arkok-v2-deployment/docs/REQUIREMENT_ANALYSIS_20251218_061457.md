# 📊 需求分析报告

**需求ID**: REQ-20251218-061457
**分析时间**: 2025-12-18 06:14:57
**分析者**: AI助手

## 📋 需求详情

**原始描述**: 备课页无法发布备课,过关页个人进度与备课页不同步,无数据沉淀,刷新后记录丢失,个人详情页打不开
**类型**: bugfix
**优先级**: high
**范围**: fullstack

## 🎯 AI助手分析

通过代码调研发现，当前项目中存在以下关键问题：

### 1. 原始需求分析
- ✅ **备课页发布功能**: 已通过1v1讲解系统实现独立的发布机制
- ✅ **过关页同步问题**: 已通过LMS服务实现数据同步
- ✅ **数据沉淀问题**: 已通过TimelineService和数据持久化解决
- ✅ **个人详情页**: StudentDetail.tsx已实现并可正常访问

### 2. 新发现的需求: 家长端功能缺失
根据`融合计划.md`第197-201行，家长端应有三个Tab：
- 📅 Tab 1: 今日动态 (TimelineEvents) ✅ **已有基础架构**
- 📊 **Tab 2: 成长档案** ❌ **进击曲线功能缺失**
- 👨‍👩‍👧 Tab 3: 家校互联 (DailySummary) ✅ **已有基础架构**

### 3. 具体缺失功能分析
**家长端Tab2 "进击曲线"需求**:
- ❌ **图表组件**: 没有实现数据可视化图表
- ❌ **数据源问题**: 应显示经验值增长趋势，而非积分增长
- ❌ **等级升级逻辑**: 经验值增加时应触发相应的等级升级显示
- ❌ **历史数据**: 缺少历史经验值数据的获取和展示

**家长端整体前端页面缺失**:
- ❌ **完整页面**: ParentArchive.tsx只是基础框架
- ❌ **数据可视化**: 缺少五维雷达图、毅力热力图、进击曲线
- ❌ **交互功能**: 缺少分享海报生成功能

## 🚀 执行计划

### Phase 1: 家长端Tab2进击曲线实现
1. **数据源修正**: 将进击曲线数据源从积分改为经验值
2. **图表组件开发**: 实现经验值增长趋势图表
3. **等级升级逻辑**: 实现经验值到等级的转换和升级动画
4. **历史数据API**: 提供学生历史经验值数据的获取接口

### Phase 2: 家长端前端页面完善
1. **五维雷达图**: 实现学生能力维度可视化
2. **毅力热力图**: 实现学习连续性热力图展示
3. **分享海报**: 实现成长周报海报生成功能
4. **数据聚合**: 完善TimelineEvent数据的聚合逻辑

## 📈 执行进度

- [x] 需求记录
- [x] 需求分析和代码调研
- [x] 执行计划制定
- [ ] **Phase 1: 家长端Tab2进击曲线实现**
  - [ ] 数据源修正（积分→经验值）
  - [ ] 图表组件开发
  - [ ] 等级升级逻辑实现
  - [ ] 历史数据API开发
- [ ] **Phase 2: 家长端前端页面完善**
  - [ ] 五维雷达图实现
  - [ ] 毅力热力图实现
  - [ ] 分享海报功能
  - [ ] 数据聚合逻辑完善
- [ ] 验证测试

## 🔍 技术要点

### 数据库层面
- ✅ `students.exp` 字段已存在
- ✅ `task_records.expAwarded` 字段已存在
- 🔄 需要实现历史经验值数据的聚合查询

### 服务层
- ✅ TimelineService已实现基础功能
- 🔄 需要扩展经验值趋势查询接口
- 🔄 需要实现等级计算逻辑

### 前端组件
- 🔄 需要开发图表组件库（可使用Chart.js或类似库）
- 🔄 需要实现响应式数据可视化
- 🔄 需要集成到ParentArchive.tsx页面

## 📝 备注

此需求是在原始bug修复需求基础上发现的新功能需求，属于家长端功能完善的重要组成部分。建议优先实现进击曲线的数据源修正和基础图表展示功能。

